!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=60)}({13:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(2);t.isIFrame=window.parent!==window,t.log=function(e,n="DEBUG"){var r=(()=>{var e=(new Error).stack.split("\n");if(!(e.length<4))return e[3].match(/\b[\w.]+\b:\d+/g).pop()})();o.default.runtime.sendMessage({activity:"log",filename:`${t.isIFrame?"(iframe)":""}${r||""}`,severity:n,log:e})}},2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=[],r={};t.default=function(){var e=(()=>{if("object"==typeof browser){var e=Object.create(browser);e.notifications={clear:function(e,t){t(!1)},create:function(e,t,n){null!=t&&void 0!==t.priority&&null!==t.priority&&t.priority>0&&window.alert(t.message),n(e)},onButtonClicked:{addListener:function(e){}},onClicked:{addListener:function(e){}}},e.runtime={getPlatformInfo:function(e){}}}else if("object"==typeof chrome)return Object.create(chrome)})();if(window.jasmine){e=function e(t,n){for(const[o,r]of Object.entries(n))t[o]?typeof r==typeof t[o]?Array.isArray(r)?t[o]=t[o].concat(r):t[o]="object"!=typeof r?r:e(t[o],r):console.log(`skipping ${o} due to conflicting types`):t[o]=r;return t}(e||{},{mock:!0,browserAction:{setIcon:function(e){}},extension:{getURL:function(e){return""}},i18n:{getUILanguage:function(e,t){return""},getMessage:function(){return""}},runtime:{onMessage:{addListener:function(e){o.push(e)},removeListener:function(e){o.splice(o.indexOf(e),1)}},sendMessage:function(e){for(let t=0;t<o.length;++t)o[t](e)},id:"ndjpnladcallmjemlbaebfadecfhkepb"},storage:{local:{get:function(e,t){t({[e]:r[e]})},set:function(e){for(const t in e)e.hasOwnProperty(t)&&(r[t]=e[t])},remove:function(e,t){delete r[e],t(r)},clear:function(e,t){r={}}}},tabs:{create:function(e,t){t&&t({})}}}),window.chrome||(window.chrome=e)}return window.BrowserHandler||(window.BrowserHandler=e),e}()},60:function(e,t,n){e.exports=n(61)},61:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(13);let r=null;o.isIFrame||"login.microsoftonline.com"!==location.hostname||o.log("Loaded "+location.href),window.addEventListener("message",(function(e){if(e.data.channel)try{if("53ee284d-920a-4b59-9d30-a60315b26836"!==e.data.channel)return void o.log("bad channel: "+e.data);if(e.source!==window)return void o.log("invalid event.source: "+e.source);const i=e.data,c=i.body.method;if("CreateProviderAsync"===c){const e=document.getElementById("ch-53ee284d-920a-4b59-9d30-a60315b26836");if(e){var t=document.createElement("div");t.id=chrome.runtime.id;var n=chrome.runtime.getManifest().version;n&&t.setAttribute("ver",n),e.appendChild(t)}}else"Response"===c||(i.extensionId===chrome.runtime.id?(r||(r={Call:function(e){try{chrome.runtime.sendMessage({activity:"sso",body:e.body},(function(t){if(null!=t)r.Callback(e,t);else{const t=chrome.runtime.lastError?chrome.runtime.lastError.message:"No response";r.Callback(e,{status:"Fail",code:"ContentError",description:t})}}))}catch(t){r.Callback(e,{status:"Fail",code:"ContentError",description:t.toString()})}},Callback:function(e,t){const n={channel:"53ee284d-920a-4b59-9d30-a60315b26836",extensionId:chrome.runtime.id,responseId:e.responseId,body:{method:"Response",response:t}};o.log("SSO response status: "+JSON.stringify(t.status),"Fail"===t.status?"ERROR":"DEBUG"),window.postMessage(n,location.origin)}}),r.Call(i)):o.log(`method: ${c} not handled, location: ${location.href}`))}catch(e){o.log("caught exception: "+JSON.stringify(e),"INFO")}}),!0)}});