{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./app/content/content.helper.ts","webpack:///./app/common/browserHandler.ts","webpack:///./app/content/auth.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","isIFrame","window","parent","message","severity","scriptfile","stack","Error","split","length","match","pop","runtime","sendMessage","activity","filename","log","browserListeners","propertyList","browserHandler","browser","edgeBrowser","notifications","clear","notificationId","callback","options","priority","alert","onButtonClicked","addListener","onClicked","getPlatformInfo","chrome","jasmine","mergeProperties","target","source","entries","Array","isArray","concat","console","mock","browserAction","setIcon","icon","extension","getURL","i18n","getUILanguage","getMessage","onMessage","listener","push","removeListener","splice","indexOf","id","storage","local","set","data","remove","tabs","createProperties","BrowserHandler","notifyAuthentication","type","params","origin","location","close","assign","hash","href","addEventListener","baseAndParams","URLSearchParams","result","parseParams","state","includes","code","pathname"],"mappings":"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","file":"\\content\\auth.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 57);\n","import BrowserHandler from '../common/browserHandler';\r\n\r\n('use strict');\r\n\r\nexport const isIFrame = window.parent !== window;\r\nexport function log(message: string, severity = 'DEBUG'): void {\r\n    var scriptfile = ((): string => {\r\n        var stack = new Error().stack.split('\\n');\r\n        if (stack.length < 4) {\r\n            return undefined;\r\n        }\r\n\r\n        var location = stack[3].match(/\\b[\\w.]+\\b:\\d+/g);\r\n        return location.pop();\r\n    })();\r\n\r\n    BrowserHandler.runtime.sendMessage({\r\n        activity: 'log',\r\n        filename: `${isIFrame ? '(iframe)' : ''}${scriptfile || ''}`,\r\n        severity,\r\n        log: message,\r\n    });\r\n}\r\n","declare let browser: any;\r\ndeclare let chrome: any;\r\n\r\nvar browserListeners: any[] = [];\r\nvar propertyList = {};\r\n\r\nfunction mergeProperties(target: any, source: any): any {\r\n    for (const [key, value] of Object.entries(source)) {\r\n        if (!target[key]) {\r\n            target[key] = value;\r\n            continue;\r\n        }\r\n\r\n        if (typeof value !== typeof target[key]) {\r\n            console.log(`skipping ${key} due to conflicting types`);\r\n            continue;\r\n        }\r\n\r\n        if (Array.isArray(value)) {\r\n            target[key] = target[key].concat(value);\r\n            continue;\r\n        }\r\n\r\n        if (typeof value === 'object') {\r\n            target[key] = mergeProperties(target[key], value);\r\n            continue;\r\n        }\r\n        target[key] = value;\r\n    }\r\n\r\n    return target;\r\n}\r\n\r\nexport default (function (): any {\r\n    var browserHandler = ((): any => {\r\n        if (typeof browser === 'object') {\r\n            var edgeBrowser = Object.create(browser);\r\n\r\n            edgeBrowser.notifications = {\r\n                clear: function (notificationId: string, callback: (wasCleared: boolean) => void): void {\r\n                    // Invoke callback with wasCleared == false\r\n                    callback(false);\r\n                },\r\n                create: function (\r\n                    notificationId: string,\r\n                    options: chrome.notifications.NotificationOptions,\r\n                    callback: (notificationId: string) => void\r\n                ): void {\r\n                    // Use window alert dialog to display notification message\r\n                    if (typeof options !== 'undefined' && options !== null) {\r\n                        // Only show when priority is 1 or 2\r\n                        if (typeof options.priority !== 'undefined' && options.priority !== null && options.priority > 0) {\r\n                            window.alert(options.message);\r\n                        }\r\n                    }\r\n\r\n                    // Invoke callback with notification id\r\n                    callback(notificationId);\r\n                },\r\n                onButtonClicked: {\r\n                    addListener: function (notificationId: string): void {\r\n                        // Not implemented\r\n                    },\r\n                },\r\n                onClicked: {\r\n                    addListener: function (notificationId: string): void {\r\n                        // Not implemented\r\n                    },\r\n                },\r\n            };\r\n\r\n            edgeBrowser.runtime = {\r\n                getPlatformInfo: function (callback: (platformInfo: chrome.runtime.PlatformInfo) => void): void {\r\n                    // Does not execute the callback function\r\n                    // Not implemented\r\n                },\r\n            };\r\n        } else if (typeof chrome === 'object') {\r\n            return Object.create(chrome);\r\n        }\r\n    })();\r\n\r\n    // when running in tests, provide override the necessary functions\r\n    if ((window as any).jasmine) {\r\n        const browserMock = {\r\n            mock: true,\r\n            browserAction: {\r\n                setIcon: function (icon: string): void {},\r\n            },\r\n            extension: {\r\n                getURL: function (name: any): string {\r\n                    return '';\r\n                },\r\n            },\r\n            i18n: {\r\n                getUILanguage: function (name: any, callback: any): string {\r\n                    return '';\r\n                },\r\n                getMessage: function (): string {\r\n                    return '';\r\n                },\r\n            },\r\n            runtime: {\r\n                onMessage: {\r\n                    addListener: function (listener: any): any {\r\n                        browserListeners.push(listener);\r\n                    },\r\n                    removeListener: function (listener: any): void {\r\n                        browserListeners.splice(browserListeners.indexOf(listener), 1);\r\n                    },\r\n                },\r\n                sendMessage: function (message: any): any {\r\n                    for (let i = 0; i < browserListeners.length; ++i) {\r\n                        browserListeners[i](message);\r\n                    }\r\n                },\r\n                id: 'ndjpnladcallmjemlbaebfadecfhkepb',\r\n            },\r\n            storage: {\r\n                local: {\r\n                    get: function (name: string, callback: (arg0: { [x: number]: any }) => void): any {\r\n                        callback({\r\n                            [name]: (propertyList as any)[name],\r\n                        });\r\n                    },\r\n\r\n                    set: function (data: { [x: string]: any; hasOwnProperty: (arg0: string) => any }): void {\r\n                        for (const key in data) {\r\n                            if (data.hasOwnProperty(key)) {\r\n                                (propertyList as any)[key] = /*JSON.stringify*/ data[key];\r\n                            }\r\n                        }\r\n                    },\r\n\r\n                    remove: function (name: string | number, callback: (arg0: any) => void): void {\r\n                        delete (propertyList as any)[name];\r\n                        callback(propertyList);\r\n                    },\r\n\r\n                    clear: function (name: any, callback: any): void {\r\n                        propertyList = {};\r\n                    },\r\n                },\r\n            },\r\n            tabs: {\r\n                create: function (createProperties: any, callback: (arg0: {}) => void): void {\r\n                    if (callback) callback({});\r\n                },\r\n            },\r\n        };\r\n        browserHandler = mergeProperties(browserHandler || {}, browserMock);\r\n        if (!(window as any).chrome) {\r\n            (window as any).chrome = browserHandler;\r\n        }\r\n    }\r\n\r\n    if (!(window as any).BrowserHandler) {\r\n        (window as any).BrowserHandler = browserHandler;\r\n    }\r\n\r\n    return browserHandler;\r\n})();\r\n","import BrowserHandler from '../common/browserHandler';\r\nimport { isIFrame, log } from './content.helper';\r\n\r\n('use strict');\r\n\r\nlog(`navigated to: ${location.href}`);\r\n\r\nfunction notifyAuthentication(type: string, params: any): void {\r\n    const message = {\r\n        activity: 'authorization',\r\n        origin: window.location.origin,\r\n        type,\r\n        close: true,\r\n    };\r\n\r\n    Object.assign(message, params);\r\n\r\n    // clear the hash so refresh will not cause another notification\r\n    location.hash = '';\r\n    BrowserHandler.runtime.sendMessage(message);\r\n}\r\n\r\nfunction isResponse(): boolean {\r\n    return location.hash.length > 0;\r\n}\r\n\r\nfunction parseParams(href: string): any {\r\n    const baseAndParams = href.split(/[?#]/);\r\n    if (baseAndParams.length < 2) {\r\n        return {};\r\n    }\r\n    href = baseAndParams[1];\r\n    var params = new URLSearchParams(href);\r\n    var result: any = {};\r\n    for (var [name, value] of params.entries()) {\r\n        result[name] = value;\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\n// Function is triggered when the live login window pops up\r\nwindow.addEventListener('load', function (): void {\r\n    const params = parseParams(location.href);\r\n\r\n    if (!(params.state && params.state.includes('OfficeOnlineExtension'))) {\r\n        return;\r\n    }\r\n\r\n    if (window.location.origin === 'https://login.microsoftonline.com') {\r\n        if (params.code) {\r\n            notifyAuthentication('o365UserService', params);\r\n        } else if (isResponse() && location.pathname === '/common/oauth2/nativeclient') {\r\n            notifyAuthentication('msidUserService', params);\r\n        }\r\n    } else if (window.location.origin === 'https://login.live.com') {\r\n        if (params.code) {\r\n            notifyAuthentication('msaUserService', params);\r\n        } else if (location.pathname === '/oauth20_authorize') {\r\n            notifyAuthentication('msidUserService', params);\r\n        }\r\n    }\r\n});\r\n"],"sourceRoot":""}