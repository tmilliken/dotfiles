{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./app/common/browserHandler.ts","webpack:///./app/nucleus/nucleus.background.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","browserListeners","propertyList","browserHandler","browser","edgeBrowser","notifications","clear","notificationId","callback","options","priority","window","alert","message","onButtonClicked","addListener","onClicked","runtime","getPlatformInfo","chrome","jasmine","mergeProperties","target","source","entries","Array","isArray","concat","console","log","mock","browserAction","setIcon","icon","extension","getURL","i18n","getUILanguage","getMessage","onMessage","listener","push","removeListener","splice","indexOf","sendMessage","length","id","storage","local","set","data","remove","tabs","createProperties","BrowserHandler","request","sender","sendResponse","activity","sendNativeMessage","nativeResponse","lastError","success","sendNucleusProviderMessage","body"],"mappings":"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","file":"\\nucleus\\nucleus.background.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 64);\n","declare let browser: any;\r\ndeclare let chrome: any;\r\n\r\nvar browserListeners: any[] = [];\r\nvar propertyList = {};\r\n\r\nfunction mergeProperties(target: any, source: any): any {\r\n    for (const [key, value] of Object.entries(source)) {\r\n        if (!target[key]) {\r\n            target[key] = value;\r\n            continue;\r\n        }\r\n\r\n        if (typeof value !== typeof target[key]) {\r\n            console.log(`skipping ${key} due to conflicting types`);\r\n            continue;\r\n        }\r\n\r\n        if (Array.isArray(value)) {\r\n            target[key] = target[key].concat(value);\r\n            continue;\r\n        }\r\n\r\n        if (typeof value === 'object') {\r\n            target[key] = mergeProperties(target[key], value);\r\n            continue;\r\n        }\r\n        target[key] = value;\r\n    }\r\n\r\n    return target;\r\n}\r\n\r\nexport default (function (): any {\r\n    var browserHandler = ((): any => {\r\n        if (typeof browser === 'object') {\r\n            var edgeBrowser = Object.create(browser);\r\n\r\n            edgeBrowser.notifications = {\r\n                clear: function (notificationId: string, callback: (wasCleared: boolean) => void): void {\r\n                    // Invoke callback with wasCleared == false\r\n                    callback(false);\r\n                },\r\n                create: function (\r\n                    notificationId: string,\r\n                    options: chrome.notifications.NotificationOptions,\r\n                    callback: (notificationId: string) => void\r\n                ): void {\r\n                    // Use window alert dialog to display notification message\r\n                    if (typeof options !== 'undefined' && options !== null) {\r\n                        // Only show when priority is 1 or 2\r\n                        if (typeof options.priority !== 'undefined' && options.priority !== null && options.priority > 0) {\r\n                            window.alert(options.message);\r\n                        }\r\n                    }\r\n\r\n                    // Invoke callback with notification id\r\n                    callback(notificationId);\r\n                },\r\n                onButtonClicked: {\r\n                    addListener: function (notificationId: string): void {\r\n                        // Not implemented\r\n                    },\r\n                },\r\n                onClicked: {\r\n                    addListener: function (notificationId: string): void {\r\n                        // Not implemented\r\n                    },\r\n                },\r\n            };\r\n\r\n            edgeBrowser.runtime = {\r\n                getPlatformInfo: function (callback: (platformInfo: chrome.runtime.PlatformInfo) => void): void {\r\n                    // Does not execute the callback function\r\n                    // Not implemented\r\n                },\r\n            };\r\n        } else if (typeof chrome === 'object') {\r\n            return Object.create(chrome);\r\n        }\r\n    })();\r\n\r\n    // when running in tests, provide override the necessary functions\r\n    if ((window as any).jasmine) {\r\n        const browserMock = {\r\n            mock: true,\r\n            browserAction: {\r\n                setIcon: function (icon: string): void {},\r\n            },\r\n            extension: {\r\n                getURL: function (name: any): string {\r\n                    return '';\r\n                },\r\n            },\r\n            i18n: {\r\n                getUILanguage: function (name: any, callback: any): string {\r\n                    return '';\r\n                },\r\n                getMessage: function (): string {\r\n                    return '';\r\n                },\r\n            },\r\n            runtime: {\r\n                onMessage: {\r\n                    addListener: function (listener: any): any {\r\n                        browserListeners.push(listener);\r\n                    },\r\n                    removeListener: function (listener: any): void {\r\n                        browserListeners.splice(browserListeners.indexOf(listener), 1);\r\n                    },\r\n                },\r\n                sendMessage: function (message: any): any {\r\n                    for (let i = 0; i < browserListeners.length; ++i) {\r\n                        browserListeners[i](message);\r\n                    }\r\n                },\r\n                id: 'ndjpnladcallmjemlbaebfadecfhkepb',\r\n            },\r\n            storage: {\r\n                local: {\r\n                    get: function (name: string, callback: (arg0: { [x: number]: any }) => void): any {\r\n                        callback({\r\n                            [name]: (propertyList as any)[name],\r\n                        });\r\n                    },\r\n\r\n                    set: function (data: { [x: string]: any; hasOwnProperty: (arg0: string) => any }): void {\r\n                        for (const key in data) {\r\n                            if (data.hasOwnProperty(key)) {\r\n                                (propertyList as any)[key] = /*JSON.stringify*/ data[key];\r\n                            }\r\n                        }\r\n                    },\r\n\r\n                    remove: function (name: string | number, callback: (arg0: any) => void): void {\r\n                        delete (propertyList as any)[name];\r\n                        callback(propertyList);\r\n                    },\r\n\r\n                    clear: function (name: any, callback: any): void {\r\n                        propertyList = {};\r\n                    },\r\n                },\r\n            },\r\n            tabs: {\r\n                create: function (createProperties: any, callback: (arg0: {}) => void): void {\r\n                    if (callback) callback({});\r\n                },\r\n            },\r\n        };\r\n        browserHandler = mergeProperties(browserHandler || {}, browserMock);\r\n        if (!(window as any).chrome) {\r\n            (window as any).chrome = browserHandler;\r\n        }\r\n    }\r\n\r\n    if (!(window as any).BrowserHandler) {\r\n        (window as any).BrowserHandler = browserHandler;\r\n    }\r\n\r\n    return browserHandler;\r\n})();\r\n","import BrowserHandler from '../common/browserHandler';\r\n\r\nconst nucleusBackgroundMessageName = 'nucleusMessage';\r\n\r\nfunction sendNucleusProviderMessage(request, sender, sendResponse) {\r\n    BrowserHandler.runtime.sendNativeMessage('com.microsoft.onedrive.nucleus.auth.provider', request,\r\n        (nativeResponse) => {\r\n            sendResponse(nativeResponse);\r\n        });\r\n\r\n    if (BrowserHandler.runtime.lastError) {\r\n        sendResponse({success: false, lastError: BrowserHandler.runtime.lastError.message});\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nBrowserHandler.runtime.onMessage.addListener(function (request, sender, sendResponse) {\r\n    switch (request.activity) {\r\n        case nucleusBackgroundMessageName:\r\n            return sendNucleusProviderMessage(request.body, sender, sendResponse);\r\n        default:\r\n            return;\r\n    }\r\n});\r\n"],"sourceRoot":""}